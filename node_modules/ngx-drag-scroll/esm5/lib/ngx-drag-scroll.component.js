/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { ElementRef, Component, Renderer2, Input, Output, EventEmitter, ViewChild, ContentChildren, QueryList, Inject, HostBinding, HostListener } from '@angular/core';
import { DOCUMENT } from '@angular/common';
import { DragScrollItemDirective } from './ngx-drag-scroll-item';
var DragScrollComponent = /** @class */ (function () {
    function DragScrollComponent(_elementRef, _renderer, _document) {
        this._elementRef = _elementRef;
        this._renderer = _renderer;
        this._document = _document;
        this._index = 0;
        this._scrollbarHidden = false;
        this._disabled = false;
        this._xDisabled = false;
        this._xWheelEnabled = false;
        this._yDisabled = false;
        this._dragDisabled = false;
        this._snapDisabled = false;
        this._snapOffset = 0;
        this._snapDuration = 500;
        this._isDragging = false;
        /**
         * Is the user currently pressing the element
         */
        this.isPressed = false;
        /**
         * Is the user currently scrolling the element
         */
        this.isScrolling = false;
        this.scrollTimer = -1;
        this.scrollToTimer = -1;
        /**
         * The x coordinates on the element
         */
        this.downX = 0;
        /**
         * The y coordinates on the element
         */
        this.downY = 0;
        this.displayType = 'block';
        this.elWidth = null;
        this.elHeight = null;
        this._pointerEvents = 'auto';
        this.scrollbarWidth = null;
        this.isAnimating = false;
        this.prevChildrenLength = 0;
        this.indexBound = 0;
        this.dsInitialized = new EventEmitter();
        this.indexChanged = new EventEmitter();
        this.reachesLeftBound = new EventEmitter();
        this.reachesRightBound = new EventEmitter();
        this.snapAnimationFinished = new EventEmitter();
        this.dragStart = new EventEmitter();
        this.dragEnd = new EventEmitter();
        this.scrollbarWidth = this.getScrollbarWidth() + "px";
    }
    Object.defineProperty(DragScrollComponent.prototype, "isDragging", {
        /**
         * Is the user currently dragging the element
         */
        get: /**
         * Is the user currently dragging the element
         * @return {?}
         */
        function () {
            return this._isDragging;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "currIndex", {
        get: /**
         * @return {?}
         */
        function () { return this._index; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (value !== this._index) {
                this._index = value;
                this.indexChanged.emit(value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "scrollbarHidden", {
        /**
         * Whether the scrollbar is hidden
         */
        get: /**
         * Whether the scrollbar is hidden
         * @return {?}
         */
        function () { return this._scrollbarHidden; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._scrollbarHidden = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "disabled", {
        /**
         * Whether horizontally and vertically draging and scrolling is be disabled
         */
        get: /**
         * Whether horizontally and vertically draging and scrolling is be disabled
         * @return {?}
         */
        function () { return this._disabled; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._disabled = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "xDisabled", {
        /**
         * Whether horizontally dragging and scrolling is be disabled
         */
        get: /**
         * Whether horizontally dragging and scrolling is be disabled
         * @return {?}
         */
        function () { return this._xDisabled; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._xDisabled = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "yDisabled", {
        /**
         * Whether vertically dragging and scrolling events is disabled
         */
        get: /**
         * Whether vertically dragging and scrolling events is disabled
         * @return {?}
         */
        function () { return this._yDisabled; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._yDisabled = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "xWheelEnabled", {
        /**
         * Whether scrolling horizontally with mouse wheel is enabled
         */
        get: /**
         * Whether scrolling horizontally with mouse wheel is enabled
         * @return {?}
         */
        function () { return this._xWheelEnabled; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._xWheelEnabled = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "dragDisabled", {
        get: /**
         * @return {?}
         */
        function () { return this._dragDisabled; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._dragDisabled = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "snapDisabled", {
        get: /**
         * @return {?}
         */
        function () { return this._snapDisabled; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._snapDisabled = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "snapOffset", {
        get: /**
         * @return {?}
         */
        function () { return this._snapOffset; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._snapOffset = value; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(DragScrollComponent.prototype, "snapDuration", {
        get: /**
         * @return {?}
         */
        function () { return this._snapDuration; },
        set: /**
         * @param {?} value
         * @return {?}
         */
        function (value) { this._snapDuration = value; },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.ngOnChanges = /**
     * @return {?}
     */
    function () {
        this.setScrollBar();
        if (this.xDisabled || this.disabled) {
            this.disableScroll('x');
        }
        else {
            this.enableScroll('x');
        }
        if (this.yDisabled || this.disabled) {
            this.disableScroll('y');
        }
        else {
            this.enableScroll('y');
        }
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        // auto assign computed css
        this._renderer.setAttribute(this._contentRef.nativeElement, 'drag-scroll', 'true');
        this.displayType = typeof window !== 'undefined' ? window.getComputedStyle(this._elementRef.nativeElement).display : 'block';
        this._renderer.setStyle(this._contentRef.nativeElement, 'display', this.displayType);
        this._renderer.setStyle(this._contentRef.nativeElement, 'whiteSpace', 'noWrap');
        // store ele width height for later user
        this.markElDimension();
        this._renderer.setStyle(this._contentRef.nativeElement, 'width', this.elWidth);
        this._renderer.setStyle(this._contentRef.nativeElement, 'height', this.elHeight);
        if (this.wrapper) {
            this.checkScrollbar();
        }
        this._onMouseDownListener = this._renderer.listen(this._contentRef.nativeElement, 'mousedown', this.onMouseDownHandler.bind(this));
        this._onScrollListener = this._renderer.listen(this._contentRef.nativeElement, 'scroll', this.onScrollHandler.bind(this));
        // prevent Firefox from dragging images
        this._onDragStartListener = this._renderer.listen('document', 'dragstart', (/**
         * @param {?} e
         * @return {?}
         */
        function (e) {
            e.preventDefault();
        }));
        this.checkNavStatus();
        this.dsInitialized.emit();
        this.adjustMarginToLastChild();
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.ngAfterViewChecked = /**
     * @return {?}
     */
    function () {
        // avoid extra checks
        if (this._children['_results'].length !== this.prevChildrenLength) {
            this.markElDimension();
            this.checkScrollbar();
            this.prevChildrenLength = this._children['_results'].length;
            this.checkNavStatus();
        }
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        this._renderer.setAttribute(this._contentRef.nativeElement, 'drag-scroll', 'false');
        if (this._onMouseDownListener) {
            this._onMouseDownListener = this._onMouseDownListener();
        }
        if (this._onScrollListener) {
            this._onScrollListener = this._onScrollListener();
        }
        if (this._onDragStartListener) {
            this._onDragStartListener = this._onDragStartListener();
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DragScrollComponent.prototype.onMouseMoveHandler = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.onMouseMove(event);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DragScrollComponent.prototype.onMouseMove = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this.isPressed && !this.disabled) {
            // Workaround for prevent scroll stuck if browser lost focus
            // MouseEvent.buttons not support by Safari
            // tslint:disable-next-line:deprecation
            if (!event.buttons && !event.which) {
                return this.onMouseUpHandler(event);
            }
            this._pointerEvents = 'none';
            this._setIsDragging(true);
            // Drag X
            if (!this.xDisabled && !this.dragDisabled) {
                /** @type {?} */
                var clientX = ((/** @type {?} */ (event))).clientX;
                this._contentRef.nativeElement.scrollLeft =
                    this._contentRef.nativeElement.scrollLeft - clientX + this.downX;
                this.downX = clientX;
            }
            // Drag Y
            if (!this.yDisabled && !this.dragDisabled) {
                /** @type {?} */
                var clientY = ((/** @type {?} */ (event))).clientY;
                this._contentRef.nativeElement.scrollTop =
                    this._contentRef.nativeElement.scrollTop - clientY + this.downY;
                this.downY = clientY;
            }
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DragScrollComponent.prototype.onMouseDownHandler = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var dragScrollItem = this.locateDragScrollItem((/** @type {?} */ (event.target)));
        if (dragScrollItem && dragScrollItem.dragDisabled) {
            return;
        }
        /** @type {?} */
        var isTouchEvent = event.type === 'touchstart';
        this._startGlobalListening(isTouchEvent);
        this.isPressed = true;
        /** @type {?} */
        var mouseEvent = (/** @type {?} */ (event));
        this.downX = mouseEvent.clientX;
        this.downY = mouseEvent.clientY;
        clearTimeout((/** @type {?} */ (this.scrollToTimer)));
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.onScrollHandler = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.checkNavStatus();
        if (!this.isPressed && !this.isAnimating && !this.snapDisabled) {
            this.isScrolling = true;
            clearTimeout((/** @type {?} */ (this.scrollTimer)));
            this.scrollTimer = setTimeout((/**
             * @return {?}
             */
            function () {
                _this.isScrolling = false;
                _this.locateCurrentIndex(true);
            }), 500);
        }
        else {
            this.locateCurrentIndex();
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DragScrollComponent.prototype.onMouseUpHandler = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this.isPressed) {
            this.isPressed = false;
            this._pointerEvents = 'auto';
            this._setIsDragging(false);
            if (!this.snapDisabled) {
                this.locateCurrentIndex(true);
            }
            else {
                this.locateCurrentIndex();
            }
            this._stopGlobalListening();
        }
    };
    /*
     * Nav button
     */
    /*
       * Nav button
       */
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.moveLeft = /*
       * Nav button
       */
    /**
     * @return {?}
     */
    function () {
        if ((this.currIndex !== 0 || this.snapDisabled)) {
            this.currIndex--;
            clearTimeout((/** @type {?} */ (this.scrollToTimer)));
            this.scrollTo(this._contentRef.nativeElement, this.toChildrenLocation(), this.snapDuration);
        }
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.moveRight = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var container = this.wrapper || this.parentNode;
        /** @type {?} */
        var containerWidth = container ? container.clientWidth : 0;
        if (!this.isScrollReachesRightEnd() && this.currIndex < this.maximumIndex(containerWidth, this._children)) {
            this.currIndex++;
            clearTimeout((/** @type {?} */ (this.scrollToTimer)));
            this.scrollTo(this._contentRef.nativeElement, this.toChildrenLocation(), this.snapDuration);
        }
    };
    /**
     * @param {?} index
     * @return {?}
     */
    DragScrollComponent.prototype.moveTo = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        /** @type {?} */
        var container = this.wrapper || this.parentNode;
        /** @type {?} */
        var containerWidth = container ? container.clientWidth : 0;
        if (index >= 0 &&
            index !== this.currIndex &&
            this.currIndex <= this.maximumIndex(containerWidth, this._children)) {
            this.currIndex = Math.min(index, this.maximumIndex(containerWidth, this._children));
            clearTimeout((/** @type {?} */ (this.scrollToTimer)));
            this.scrollTo(this._contentRef.nativeElement, this.toChildrenLocation(), this.snapDuration);
        }
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.checkNavStatus = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var onlyOneItem = Boolean(_this._children['_results'].length <= 1);
            /** @type {?} */
            var containerIsLargerThanContent = Boolean(_this._contentRef.nativeElement.scrollWidth <=
                _this._contentRef.nativeElement.clientWidth);
            if (onlyOneItem || containerIsLargerThanContent) {
                // only one element
                _this.reachesLeftBound.emit(true);
                _this.reachesRightBound.emit(true);
            }
            else if (_this.isScrollReachesRightEnd()) {
                // reached right end
                _this.reachesLeftBound.emit(false);
                _this.reachesRightBound.emit(true);
            }
            else if (_this._contentRef.nativeElement.scrollLeft === 0 &&
                _this._contentRef.nativeElement.scrollWidth > _this._contentRef.nativeElement.clientWidth) {
                // reached left end
                _this.reachesLeftBound.emit(true);
                _this.reachesRightBound.emit(false);
            }
            else {
                // in the middle
                _this.reachesLeftBound.emit(false);
                _this.reachesRightBound.emit(false);
            }
        }), 0);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    DragScrollComponent.prototype.onWheel = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (this._xWheelEnabled) {
            event.preventDefault();
            if (this._snapDisabled) {
                this._contentRef.nativeElement.scrollBy(event.deltaY, 0);
            }
            else {
                if (event.deltaY < 0) {
                    this.moveLeft();
                }
                else if (event.deltaY > 0) {
                    this.moveRight();
                }
            }
        }
    };
    /**
     * @return {?}
     */
    DragScrollComponent.prototype.onWindowResize = /**
     * @return {?}
     */
    function () {
        this.refreshWrapperDimensions();
    };
    /**
     * @private
     * @param {?} value
     * @return {?}
     */
    DragScrollComponent.prototype._setIsDragging = /**
     * @private
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (this._isDragging === value) {
            return;
        }
        this._isDragging = value;
        value ? this.dragStart.emit() : this.dragEnd.emit();
    };
    /**
     * @private
     * @param {?} isTouchEvent
     * @return {?}
     */
    DragScrollComponent.prototype._startGlobalListening = /**
     * @private
     * @param {?} isTouchEvent
     * @return {?}
     */
    function (isTouchEvent) {
        if (!this._onMouseMoveListener) {
            /** @type {?} */
            var eventName = isTouchEvent ? 'touchmove' : 'mousemove';
            this._onMouseMoveListener = this._renderer.listen('document', eventName, this.onMouseMoveHandler.bind(this));
        }
        if (!this._onMouseUpListener) {
            /** @type {?} */
            var eventName = isTouchEvent ? 'touchend' : 'mouseup';
            this._onMouseUpListener = this._renderer.listen('document', eventName, this.onMouseUpHandler.bind(this));
        }
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype._stopGlobalListening = /**
     * @private
     * @return {?}
     */
    function () {
        if (this._onMouseMoveListener) {
            this._onMouseMoveListener = this._onMouseMoveListener();
        }
        if (this._onMouseUpListener) {
            this._onMouseUpListener = this._onMouseUpListener();
        }
    };
    /**
     * @private
     * @param {?} axis
     * @return {?}
     */
    DragScrollComponent.prototype.disableScroll = /**
     * @private
     * @param {?} axis
     * @return {?}
     */
    function (axis) {
        this._renderer.setStyle(this._contentRef.nativeElement, "overflow-" + axis, 'hidden');
    };
    /**
     * @private
     * @param {?} axis
     * @return {?}
     */
    DragScrollComponent.prototype.enableScroll = /**
     * @private
     * @param {?} axis
     * @return {?}
     */
    function (axis) {
        this._renderer.setStyle(this._contentRef.nativeElement, "overflow-" + axis, 'auto');
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.hideScrollbar = /**
     * @private
     * @return {?}
     */
    function () {
        if (this._contentRef.nativeElement.style.display !== 'none' && !this.wrapper) {
            this.parentNode = this._contentRef.nativeElement.parentNode;
            // create container element
            this.wrapper = this._renderer.createElement('div');
            this._renderer.setAttribute(this.wrapper, 'class', 'drag-scroll-wrapper');
            this._renderer.addClass(this.wrapper, 'drag-scroll-container');
            this.refreshWrapperDimensions();
            this._renderer.setStyle(this.wrapper, 'overflow', 'hidden');
            this._renderer.setStyle(this._contentRef.nativeElement, 'width', "calc(100% + " + this.scrollbarWidth + ")");
            this._renderer.setStyle(this._contentRef.nativeElement, 'height', "calc(100% + " + this.scrollbarWidth + ")");
            // Append container element to component element.
            this._renderer.appendChild(this._elementRef.nativeElement, this.wrapper);
            // Append content element to container element.
            this._renderer.appendChild(this.wrapper, this._contentRef.nativeElement);
            this.adjustMarginToLastChild();
        }
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.showScrollbar = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.wrapper) {
            this._renderer.setStyle(this._contentRef.nativeElement, 'width', '100%');
            this._renderer.setStyle(this._contentRef.nativeElement, 'height', this.wrapper.style.height);
            if (this.parentNode !== null) {
                this.parentNode.removeChild(this.wrapper);
                this.parentNode.appendChild(this._contentRef.nativeElement);
            }
            this.wrapper = null;
            this.adjustMarginToLastChild();
        }
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.checkScrollbar = /**
     * @private
     * @return {?}
     */
    function () {
        if (this._contentRef.nativeElement.scrollWidth <= this._contentRef.nativeElement.clientWidth) {
            this._renderer.setStyle(this._contentRef.nativeElement, 'height', '100%');
        }
        else {
            this._renderer.setStyle(this._contentRef.nativeElement, 'height', "calc(100% + " + this.scrollbarWidth + ")");
        }
        if (this._contentRef.nativeElement.scrollHeight <= this._contentRef.nativeElement.clientHeight) {
            this._renderer.setStyle(this._contentRef.nativeElement, 'width', '100%');
        }
        else {
            this._renderer.setStyle(this._contentRef.nativeElement, 'width', "calc(100% + " + this.scrollbarWidth + ")");
        }
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.setScrollBar = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.scrollbarHidden) {
            this.hideScrollbar();
        }
        else {
            this.showScrollbar();
        }
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.getScrollbarWidth = /**
     * @private
     * @return {?}
     */
    function () {
        /**
         * Browser Scrollbar Widths (2016)
         * OSX (Chrome, Safari, Firefox) - 15px
         * Windows XP (IE7, Chrome, Firefox) - 17px
         * Windows 7 (IE10, IE11, Chrome, Firefox) - 17px
         * Windows 8.1 (IE11, Chrome, Firefox) - 17px
         * Windows 10 (IE11, Chrome, Firefox) - 17px
         * Windows 10 (Edge 12/13) - 12px
         * @type {?}
         */
        var outer = this._renderer.createElement('div');
        this._renderer.setStyle(outer, 'visibility', 'hidden');
        this._renderer.setStyle(outer, 'width', '100px');
        this._renderer.setStyle(outer, 'msOverflowStyle', 'scrollbar'); // needed for WinJS apps
        // document.body.appendChild(outer);
        this._renderer.appendChild(this._document.body, outer);
        // this._renderer.appendChild(this._renderer.selectRootElement('body'), outer);
        /** @type {?} */
        var widthNoScroll = outer.offsetWidth;
        // force scrollbars
        this._renderer.setStyle(outer, 'overflow', 'scroll');
        // add innerdiv
        /** @type {?} */
        var inner = this._renderer.createElement('div');
        this._renderer.setStyle(inner, 'width', '100%');
        this._renderer.appendChild(outer, inner);
        /** @type {?} */
        var widthWithScroll = inner.offsetWidth;
        // remove divs
        this._renderer.removeChild(this._document.body, outer);
        /**
         * Scrollbar width will be 0 on Mac OS with the
         * default "Only show scrollbars when scrolling" setting (Yosemite and up).
         * setting default width to 20;
         */
        return widthNoScroll - widthWithScroll || 20;
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.refreshWrapperDimensions = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.wrapper) {
            this._renderer.setStyle(this.wrapper, 'width', '100%');
            this._renderer.setStyle(this.wrapper, 'height', this._elementRef.nativeElement.style.height
                || this._elementRef.nativeElement.offsetHeight + 'px');
        }
    };
    /*
    * The below solution is heavily inspired from
    * https://gist.github.com/andjosh/6764939
    */
    /*
      * The below solution is heavily inspired from
      * https://gist.github.com/andjosh/6764939
      */
    /**
     * @private
     * @param {?} element
     * @param {?} to
     * @param {?} duration
     * @return {?}
     */
    DragScrollComponent.prototype.scrollTo = /*
      * The below solution is heavily inspired from
      * https://gist.github.com/andjosh/6764939
      */
    /**
     * @private
     * @param {?} element
     * @param {?} to
     * @param {?} duration
     * @return {?}
     */
    function (element, to, duration) {
        /** @type {?} */
        var self = this;
        self.isAnimating = true;
        /** @type {?} */
        var start = element.scrollLeft;
        /** @type {?} */
        var change = to - start - this.snapOffset;
        /** @type {?} */
        var increment = 20;
        /** @type {?} */
        var currentTime = 0;
        // t = current time
        // b = start value
        // c = change in value
        // d = duration
        /** @type {?} */
        var easeInOutQuad = (/**
         * @param {?} t
         * @param {?} b
         * @param {?} c
         * @param {?} d
         * @return {?}
         */
        function (t, b, c, d) {
            t /= d / 2;
            if (t < 1) {
                return c / 2 * t * t + b;
            }
            t--;
            return -c / 2 * (t * (t - 2) - 1) + b;
        });
        /** @type {?} */
        var animateScroll = (/**
         * @return {?}
         */
        function () {
            currentTime += increment;
            element.scrollLeft = easeInOutQuad(currentTime, start, change, duration);
            if (currentTime < duration) {
                self.scrollToTimer = setTimeout(animateScroll, increment);
            }
            else {
                // run one more frame to make sure the animation is fully finished
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    self.isAnimating = false;
                    self.snapAnimationFinished.emit(self.currIndex);
                }), increment);
            }
        });
        animateScroll();
    };
    /**
     * @private
     * @param {?=} snap
     * @return {?}
     */
    DragScrollComponent.prototype.locateCurrentIndex = /**
     * @private
     * @param {?=} snap
     * @return {?}
     */
    function (snap) {
        var _this = this;
        this.currentChildWidth((/**
         * @param {?} currentChildWidth
         * @param {?} nextChildrenWidth
         * @param {?} childrenWidth
         * @param {?} idx
         * @param {?} stop
         * @return {?}
         */
        function (currentChildWidth, nextChildrenWidth, childrenWidth, idx, stop) {
            if ((_this._contentRef.nativeElement.scrollLeft >= childrenWidth &&
                _this._contentRef.nativeElement.scrollLeft <= nextChildrenWidth)) {
                if (nextChildrenWidth - _this._contentRef.nativeElement.scrollLeft > currentChildWidth / 2 && !_this.isScrollReachesRightEnd()) {
                    // roll back scrolling
                    if (!_this.isAnimating) {
                        _this.currIndex = idx;
                    }
                    if (snap) {
                        _this.scrollTo(_this._contentRef.nativeElement, childrenWidth, _this.snapDuration);
                    }
                }
                else if (_this._contentRef.nativeElement.scrollLeft !== 0) {
                    // forward scrolling
                    if (!_this.isAnimating) {
                        _this.currIndex = idx + 1;
                    }
                    if (snap) {
                        _this.scrollTo(_this._contentRef.nativeElement, childrenWidth + currentChildWidth, _this.snapDuration);
                    }
                }
                stop();
            }
            else if ((idx + 1) === (_this._children['_results'].length - 1)) {
                // reaches last index
                if (!_this.isAnimating) {
                    _this.currIndex = idx + 1;
                }
                stop();
            }
        }));
    };
    /**
     * @private
     * @param {?} cb
     * @return {?}
     */
    DragScrollComponent.prototype.currentChildWidth = /**
     * @private
     * @param {?} cb
     * @return {?}
     */
    function (cb) {
        /** @type {?} */
        var childrenWidth = 0;
        /** @type {?} */
        var shouldBreak = false;
        /** @type {?} */
        var breakFunc = (/**
         * @return {?}
         */
        function () {
            shouldBreak = true;
        });
        for (var i = 0; i < this._children['_results'].length; i++) {
            if (i === this._children['_results'].length - 1) {
                break;
            }
            if (shouldBreak) {
                break;
            }
            /** @type {?} */
            var nextChildrenWidth = childrenWidth + this._children['_results'][i + 1]._elementRef.nativeElement.clientWidth;
            /** @type {?} */
            var currentClildWidth = this._children['_results'][i]._elementRef.nativeElement.clientWidth;
            cb(currentClildWidth, nextChildrenWidth, childrenWidth, i, breakFunc);
            childrenWidth += currentClildWidth;
        }
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.toChildrenLocation = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var to = 0;
        for (var i = 0; i < this.currIndex; i++) {
            to += this._children['_results'][i]._elementRef.nativeElement.clientWidth;
        }
        return to;
    };
    /**
     * @private
     * @param {?} element
     * @return {?}
     */
    DragScrollComponent.prototype.locateDragScrollItem = /**
     * @private
     * @param {?} element
     * @return {?}
     */
    function (element) {
        /** @type {?} */
        var item = null;
        for (var i = 0; i < this._children['_results'].length; i++) {
            if (element === this._children['_results'][i]._elementRef.nativeElement) {
                item = this._children['_results'][i];
            }
        }
        return item;
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.markElDimension = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.wrapper) {
            this.elWidth = this.wrapper.style.width;
            this.elHeight = this.wrapper.style.height;
        }
        else {
            this.elWidth = this._elementRef.nativeElement.style.width || (this._elementRef.nativeElement.offsetWidth + 'px');
            this.elHeight = this._elementRef.nativeElement.style.height || (this._elementRef.nativeElement.offsetHeight + 'px');
        }
        /** @type {?} */
        var container = this.wrapper || this.parentNode;
        /** @type {?} */
        var containerWidth = container ? container.clientWidth : 0;
        if (this._children['_results'].length > 1) {
            this.indexBound = this.maximumIndex(containerWidth, this._children);
        }
    };
    /**
     * @private
     * @param {?} containerWidth
     * @param {?} childrenElements
     * @return {?}
     */
    DragScrollComponent.prototype.maximumIndex = /**
     * @private
     * @param {?} containerWidth
     * @param {?} childrenElements
     * @return {?}
     */
    function (containerWidth, childrenElements) {
        /** @type {?} */
        var count = 0;
        /** @type {?} */
        var childrenWidth = 0;
        for (var i = 0; i <= childrenElements['_results'].length; i++) {
            // last N element
            /** @type {?} */
            var dragScrollItemDirective = childrenElements['_results'][childrenElements['_results'].length - 1 - i];
            if (!dragScrollItemDirective) {
                break;
            }
            else {
                /** @type {?} */
                var itemWidth = dragScrollItemDirective._elementRef.nativeElement.clientWidth;
                if (itemWidth === 0) {
                    itemWidth = dragScrollItemDirective._elementRef.nativeElement.firstElementChild.clientWidth;
                }
                childrenWidth += itemWidth;
                if (childrenWidth < containerWidth) {
                    count++;
                }
                else {
                    break;
                }
            }
        }
        return childrenElements.length - count;
    };
    /**
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.isScrollReachesRightEnd = /**
     * @private
     * @return {?}
     */
    function () {
        /** @type {?} */
        var scrollLeftPos = this._contentRef.nativeElement.scrollLeft + this._contentRef.nativeElement.offsetWidth;
        return scrollLeftPos >= this._contentRef.nativeElement.scrollWidth;
    };
    /**
     * adds a margin right style to the last child element which will resolve the issue
     * of last item gets cutoff.
     */
    /**
     * adds a margin right style to the last child element which will resolve the issue
     * of last item gets cutoff.
     * @private
     * @return {?}
     */
    DragScrollComponent.prototype.adjustMarginToLastChild = /**
     * adds a margin right style to the last child element which will resolve the issue
     * of last item gets cutoff.
     * @private
     * @return {?}
     */
    function () {
        if (this._children && this.hideScrollbar) {
            /** @type {?} */
            var lastItem = this._children['_results'][this._children['_results'].length - 1]._elementRef.nativeElement;
            if (this.wrapper && this._children['_results'].length > 1) {
                this._renderer.setStyle(lastItem, 'margin-right', this.scrollbarWidth);
            }
            else {
                this._renderer.setStyle(lastItem, 'margin-right', 0);
            }
        }
    };
    DragScrollComponent.decorators = [
        { type: Component, args: [{
                    selector: 'drag-scroll',
                    template: "\n    <div class=\"drag-scroll-content\" #contentRef>\n      <ng-content></ng-content>\n    </div>\n  ",
                    styles: ["\n    :host {\n      overflow: hidden;\n      display: block;\n    }\n    .drag-scroll-content {\n      height: 100%;\n      overflow: auto;\n      white-space: nowrap;\n    }\n    "]
                }] }
    ];
    /** @nocollapse */
    DragScrollComponent.ctorParameters = function () { return [
        { type: ElementRef, decorators: [{ type: Inject, args: [ElementRef,] }] },
        { type: Renderer2, decorators: [{ type: Inject, args: [Renderer2,] }] },
        { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }
    ]; };
    DragScrollComponent.propDecorators = {
        _contentRef: [{ type: ViewChild, args: ['contentRef',] }],
        _children: [{ type: ContentChildren, args: [DragScrollItemDirective,] }],
        _pointerEvents: [{ type: HostBinding, args: ['style.pointer-events',] }],
        dsInitialized: [{ type: Output }],
        indexChanged: [{ type: Output }],
        reachesLeftBound: [{ type: Output }],
        reachesRightBound: [{ type: Output }],
        snapAnimationFinished: [{ type: Output }],
        dragStart: [{ type: Output }],
        dragEnd: [{ type: Output }],
        scrollbarHidden: [{ type: Input, args: ['scrollbar-hidden',] }],
        disabled: [{ type: Input, args: ['drag-scroll-disabled',] }],
        xDisabled: [{ type: Input, args: ['drag-scroll-x-disabled',] }],
        yDisabled: [{ type: Input, args: ['drag-scroll-y-disabled',] }],
        xWheelEnabled: [{ type: Input, args: ['scroll-x-wheel-enabled',] }],
        dragDisabled: [{ type: Input, args: ['drag-disabled',] }],
        snapDisabled: [{ type: Input, args: ['snap-disabled',] }],
        snapOffset: [{ type: Input, args: ['snap-offset',] }],
        snapDuration: [{ type: Input, args: ['snap-duration',] }],
        onWheel: [{ type: HostListener, args: ['wheel', ['$event'],] }],
        onWindowResize: [{ type: HostListener, args: ['window:resize',] }]
    };
    return DragScrollComponent;
}());
export { DragScrollComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._index;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._scrollbarHidden;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._disabled;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._xDisabled;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._xWheelEnabled;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._yDisabled;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._dragDisabled;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._snapDisabled;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._snapOffset;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._snapDuration;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._isDragging;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._onMouseMoveListener;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._onMouseUpListener;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._onMouseDownListener;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._onScrollListener;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._onDragStartListener;
    /**
     * Is the user currently pressing the element
     * @type {?}
     */
    DragScrollComponent.prototype.isPressed;
    /**
     * Is the user currently scrolling the element
     * @type {?}
     */
    DragScrollComponent.prototype.isScrolling;
    /** @type {?} */
    DragScrollComponent.prototype.scrollTimer;
    /** @type {?} */
    DragScrollComponent.prototype.scrollToTimer;
    /**
     * The x coordinates on the element
     * @type {?}
     */
    DragScrollComponent.prototype.downX;
    /**
     * The y coordinates on the element
     * @type {?}
     */
    DragScrollComponent.prototype.downY;
    /** @type {?} */
    DragScrollComponent.prototype.displayType;
    /** @type {?} */
    DragScrollComponent.prototype.elWidth;
    /** @type {?} */
    DragScrollComponent.prototype.elHeight;
    /**
     * The parentNode of carousel Element
     * @type {?}
     */
    DragScrollComponent.prototype.parentNode;
    /**
     * The carousel Element
     * @type {?}
     */
    DragScrollComponent.prototype._contentRef;
    /** @type {?} */
    DragScrollComponent.prototype._children;
    /** @type {?} */
    DragScrollComponent.prototype._pointerEvents;
    /** @type {?} */
    DragScrollComponent.prototype.wrapper;
    /** @type {?} */
    DragScrollComponent.prototype.scrollbarWidth;
    /** @type {?} */
    DragScrollComponent.prototype.isAnimating;
    /** @type {?} */
    DragScrollComponent.prototype.prevChildrenLength;
    /** @type {?} */
    DragScrollComponent.prototype.indexBound;
    /** @type {?} */
    DragScrollComponent.prototype.dsInitialized;
    /** @type {?} */
    DragScrollComponent.prototype.indexChanged;
    /** @type {?} */
    DragScrollComponent.prototype.reachesLeftBound;
    /** @type {?} */
    DragScrollComponent.prototype.reachesRightBound;
    /** @type {?} */
    DragScrollComponent.prototype.snapAnimationFinished;
    /** @type {?} */
    DragScrollComponent.prototype.dragStart;
    /** @type {?} */
    DragScrollComponent.prototype.dragEnd;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._elementRef;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._renderer;
    /**
     * @type {?}
     * @private
     */
    DragScrollComponent.prototype._document;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWRyYWctc2Nyb2xsLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1kcmFnLXNjcm9sbC8iLCJzb3VyY2VzIjpbImxpYi9uZ3gtZHJhZy1zY3JvbGwuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0wsVUFBVSxFQUNWLFNBQVMsRUFDVCxTQUFTLEVBRVQsS0FBSyxFQUNMLE1BQU0sRUFHTixZQUFZLEVBQ1osU0FBUyxFQUNULGVBQWUsRUFFZixTQUFTLEVBQ1QsTUFBTSxFQUNOLFdBQVcsRUFDWCxZQUFZLEVBQ2IsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRTNDLE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBRWpFO0lBMkxFLDZCQUM4QixXQUF1QixFQUN4QixTQUFvQixFQUNyQixTQUFjO1FBRlosZ0JBQVcsR0FBWCxXQUFXLENBQVk7UUFDeEIsY0FBUyxHQUFULFNBQVMsQ0FBVztRQUNyQixjQUFTLEdBQVQsU0FBUyxDQUFLO1FBMUtsQyxXQUFNLEdBQUcsQ0FBQyxDQUFDO1FBRVgscUJBQWdCLEdBQUcsS0FBSyxDQUFDO1FBRXpCLGNBQVMsR0FBRyxLQUFLLENBQUM7UUFFbEIsZUFBVSxHQUFHLEtBQUssQ0FBQztRQUVuQixtQkFBYyxHQUFHLEtBQUssQ0FBQztRQUV2QixlQUFVLEdBQUcsS0FBSyxDQUFDO1FBRW5CLGtCQUFhLEdBQUcsS0FBSyxDQUFDO1FBRXRCLGtCQUFhLEdBQUcsS0FBSyxDQUFDO1FBRXRCLGdCQUFXLEdBQUcsQ0FBQyxDQUFDO1FBRWhCLGtCQUFhLEdBQUcsR0FBRyxDQUFDO1FBRXBCLGdCQUFXLEdBQUcsS0FBSyxDQUFDOzs7O1FBZTVCLGNBQVMsR0FBRyxLQUFLLENBQUM7Ozs7UUFLbEIsZ0JBQVcsR0FBRyxLQUFLLENBQUM7UUFFcEIsZ0JBQVcsR0FBMEIsQ0FB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O0lBRXBELCtDQUF5RDs7SUFFekQsZ0RBQTBEOztJQUUxRCxvREFBNkQ7O0lBRTdELHdDQUErQzs7SUFFL0Msc0NBQTZDOzs7OztJQXNEM0MsMENBQW1EOzs7OztJQUNuRCx3Q0FBK0M7Ozs7O0lBQy9DLHdDQUF3QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEVsZW1lbnRSZWYsXG4gIENvbXBvbmVudCxcbiAgUmVuZGVyZXIyLFxuICBPbkRlc3Ryb3ksXG4gIElucHV0LFxuICBPdXRwdXQsXG4gIEFmdGVyVmlld0luaXQsXG4gIE9uQ2hhbmdlcyxcbiAgRXZlbnRFbWl0dGVyLFxuICBWaWV3Q2hpbGQsXG4gIENvbnRlbnRDaGlsZHJlbixcbiAgQWZ0ZXJWaWV3Q2hlY2tlZCxcbiAgUXVlcnlMaXN0LFxuICBJbmplY3QsXG4gIEhvc3RCaW5kaW5nLFxuICBIb3N0TGlzdGVuZXJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBET0NVTUVOVCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5cbmltcG9ydCB7IERyYWdTY3JvbGxJdGVtRGlyZWN0aXZlIH0gZnJvbSAnLi9uZ3gtZHJhZy1zY3JvbGwtaXRlbSc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2RyYWctc2Nyb2xsJyxcbiAgdGVtcGxhdGU6IGBcbiAgICA8ZGl2IGNsYXNzPVwiZHJhZy1zY3JvbGwtY29udGVudFwiICNjb250ZW50UmVmPlxuICAgICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuICAgIDwvZGl2PlxuICBgLFxuICBzdHlsZXM6IFtgXG4gICAgOmhvc3Qge1xuICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIH1cbiAgICAuZHJhZy1zY3JvbGwtY29udGVudCB7XG4gICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICBvdmVyZmxvdzogYXV0bztcbiAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gICAgfVxuICAgIGBdXG59KVxuZXhwb3J0IGNsYXNzIERyYWdTY3JvbGxDb21wb25lbnQgaW1wbGVtZW50cyBPbkRlc3Ryb3ksIEFmdGVyVmlld0luaXQsIE9uQ2hhbmdlcywgQWZ0ZXJWaWV3Q2hlY2tlZCB7XG4gIHByaXZhdGUgX2luZGV4ID0gMDtcblxuICBwcml2YXRlIF9zY3JvbGxiYXJIaWRkZW4gPSBmYWxzZTtcblxuICBwcml2YXRlIF9kaXNhYmxlZCA9IGZhbHNlO1xuXG4gIHByaXZhdGUgX3hEaXNhYmxlZCA9IGZhbHNlO1xuXG4gIHByaXZhdGUgX3hXaGVlbEVuYWJsZWQgPSBmYWxzZTtcblxuICBwcml2YXRlIF95RGlzYWJsZWQgPSBmYWxzZTtcblxuICBwcml2YXRlIF9kcmFnRGlzYWJsZWQgPSBmYWxzZTtcblxuICBwcml2YXRlIF9zbmFwRGlzYWJsZWQgPSBmYWxzZTtcblxuICBwcml2YXRlIF9zbmFwT2Zmc2V0ID0gMDtcblxuICBwcml2YXRlIF9zbmFwRHVyYXRpb24gPSA1MDA7XG5cbiAgcHJpdmF0ZSBfaXNEcmFnZ2luZyA9IGZhbHNlO1xuXG4gIHByaXZhdGUgX29uTW91c2VNb3ZlTGlzdGVuZXI6IEZ1bmN0aW9uO1xuXG4gIHByaXZhdGUgX29uTW91c2VVcExpc3RlbmVyOiBGdW5jdGlvbjtcblxuICBwcml2YXRlIF9vbk1vdXNlRG93bkxpc3RlbmVyOiBGdW5jdGlvbjtcblxuICBwcml2YXRlIF9vblNjcm9sbExpc3RlbmVyOiBGdW5jdGlvbjtcblxuICBwcml2YXRlIF9vbkRyYWdTdGFydExpc3RlbmVyOiBGdW5jdGlvbjtcblxuICAvKipcbiAgICogSXMgdGhlIHVzZXIgY3VycmVudGx5IHByZXNzaW5nIHRoZSBlbGVtZW50XG4gICAqL1xuICBpc1ByZXNzZWQgPSBmYWxzZTtcblxuICAvKipcbiAgICogSXMgdGhlIHVzZXIgY3VycmVudGx5IHNjcm9sbGluZyB0aGUgZWxlbWVudFxuICAgKi9cbiAgaXNTY3JvbGxpbmcgPSBmYWxzZTtcblxuICBzY3JvbGxUaW1lcjogbnVtYmVyIHwgTm9kZUpTLlRpbWVyID0gLTE7XG5cbiAgc2Nyb2xsVG9UaW1lcjogbnVtYmVyIHwgTm9kZUpTLlRpbWVyID0gLTE7XG5cbiAgLyoqXG4gICAqIElzIHRoZSB1c2VyIGN1cnJlbnRseSBkcmFnZ2luZyB0aGUgZWxlbWVudFxuICAgKi9cbiAgZ2V0IGlzRHJhZ2dpbmcoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2lzRHJhZ2dpbmc7XG4gIH1cblxuICAvKipcbiAgICogVGhlIHggY29vcmRpbmF0ZXMgb24gdGhlIGVsZW1lbnRcbiAgICovXG4gIGRvd25YID0gMDtcblxuICAvKipcbiAgICogVGhlIHkgY29vcmRpbmF0ZXMgb24gdGhlIGVsZW1lbnRcbiAgICovXG4gIGRvd25ZID0gMDtcblxuICBkaXNwbGF5VHlwZTogc3RyaW5nIHwgbnVsbCA9ICdibG9jayc7XG5cbiAgZWxXaWR0aDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgZWxIZWlnaHQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuXG4gIC8qKlxuICAgKiBUaGUgcGFyZW50Tm9kZSBvZiBjYXJvdXNlbCBFbGVtZW50XG4gICAqL1xuICBwYXJlbnROb2RlOiBIVE1MRWxlbWVudDtcblxuICAvKipcbiAgICogVGhlIGNhcm91c2VsIEVsZW1lbnRcbiAgICovXG5cbiAgQFZpZXdDaGlsZCgnY29udGVudFJlZicpIF9jb250ZW50UmVmOiBFbGVtZW50UmVmO1xuXG4gIEBDb250ZW50Q2hpbGRyZW4oRHJhZ1Njcm9sbEl0ZW1EaXJlY3RpdmUpIF9jaGlsZHJlbjogUXVlcnlMaXN0PERyYWdTY3JvbGxJdGVtRGlyZWN0aXZlPjtcblxuICBASG9zdEJpbmRpbmcoJ3N0eWxlLnBvaW50ZXItZXZlbnRzJykgX3BvaW50ZXJFdmVudHMgPSAnYXV0byc7XG5cbiAgd3JhcHBlcjogSFRNTERpdkVsZW1lbnQgfCBudWxsO1xuXG4gIHNjcm9sbGJhcldpZHRoOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICBnZXQgY3VyckluZGV4KCkgeyByZXR1cm4gdGhpcy5faW5kZXg7IH1cbiAgc2V0IGN1cnJJbmRleCh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSAhPT0gdGhpcy5faW5kZXgpIHtcbiAgICAgIHRoaXMuX2luZGV4ID0gdmFsdWU7XG4gICAgICB0aGlzLmluZGV4Q2hhbmdlZC5lbWl0KHZhbHVlKTtcbiAgICB9XG4gIH1cblxuICBpc0FuaW1hdGluZyA9IGZhbHNlO1xuXG4gIHByZXZDaGlsZHJlbkxlbmd0aCA9IDA7XG5cbiAgaW5kZXhCb3VuZCA9IDA7XG5cbiAgQE91dHB1dCgpIGRzSW5pdGlhbGl6ZWQgPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG5cbiAgQE91dHB1dCgpIGluZGV4Q2hhbmdlZCA9IG5ldyBFdmVudEVtaXR0ZXI8bnVtYmVyPigpO1xuXG4gIEBPdXRwdXQoKSByZWFjaGVzTGVmdEJvdW5kID0gbmV3IEV2ZW50RW1pdHRlcjxib29sZWFuPigpO1xuXG4gIEBPdXRwdXQoKSByZWFjaGVzUmlnaHRCb3VuZCA9IG5ldyBFdmVudEVtaXR0ZXI8Ym9vbGVhbj4oKTtcblxuICBAT3V0cHV0KCkgc25hcEFuaW1hdGlvbkZpbmlzaGVkID0gbmV3IEV2ZW50RW1pdHRlcjxudW1iZXI+KCk7XG5cbiAgQE91dHB1dCgpIGRyYWdTdGFydCA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcblxuICBAT3V0cHV0KCkgZHJhZ0VuZCA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcblxuICAvKipcbiAgICogV2hldGhlciB0aGUgc2Nyb2xsYmFyIGlzIGhpZGRlblxuICAgKi9cbiAgQElucHV0KCdzY3JvbGxiYXItaGlkZGVuJylcbiAgZ2V0IHNjcm9sbGJhckhpZGRlbigpIHsgcmV0dXJuIHRoaXMuX3Njcm9sbGJhckhpZGRlbjsgfVxuICBzZXQgc2Nyb2xsYmFySGlkZGVuKHZhbHVlOiBib29sZWFuKSB7IHRoaXMuX3Njcm9sbGJhckhpZGRlbiA9IHZhbHVlOyB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgaG9yaXpvbnRhbGx5IGFuZCB2ZXJ0aWNhbGx5IGRyYWdpbmcgYW5kIHNjcm9sbGluZyBpcyBiZSBkaXNhYmxlZFxuICAgKi9cbiAgQElucHV0KCdkcmFnLXNjcm9sbC1kaXNhYmxlZCcpXG4gIGdldCBkaXNhYmxlZCgpIHsgcmV0dXJuIHRoaXMuX2Rpc2FibGVkOyB9XG4gIHNldCBkaXNhYmxlZCh2YWx1ZTogYm9vbGVhbikgeyB0aGlzLl9kaXNhYmxlZCA9IHZhbHVlOyB9XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgaG9yaXpvbnRhbGx5IGRyYWdnaW5nIGFuZCBzY3JvbGxpbmcgaXMgYmUgZGlzYWJsZWRcbiAgICovXG4gIEBJbnB1dCgnZHJhZy1zY3JvbGwteC1kaXNhYmxlZCcpXG4gIGdldCB4RGlzYWJsZWQoKSB7IHJldHVybiB0aGlzLl94RGlzYWJsZWQ7IH1cbiAgc2V0IHhEaXNhYmxlZCh2YWx1ZTogYm9vbGVhbikgeyB0aGlzLl94RGlzYWJsZWQgPSB2YWx1ZTsgfVxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHZlcnRpY2FsbHkgZHJhZ2dpbmcgYW5kIHNjcm9sbGluZyBldmVudHMgaXMgZGlzYWJsZWRcbiAgICovXG4gIEBJbnB1dCgnZHJhZy1zY3JvbGwteS1kaXNhYmxlZCcpXG4gIGdldCB5RGlzYWJsZWQoKSB7IHJldHVybiB0aGlzLl95RGlzYWJsZWQ7IH1cbiAgc2V0IHlEaXNhYmxlZCh2YWx1ZTogYm9vbGVhbikgeyB0aGlzLl95RGlzYWJsZWQgPSB2YWx1ZTsgfVxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHNjcm9sbGluZyBob3Jpem9udGFsbHkgd2l0aCBtb3VzZSB3aGVlbCBpcyBlbmFibGVkXG4gICAqL1xuICBASW5wdXQoJ3Njcm9sbC14LXdoZWVsLWVuYWJsZWQnKVxuICBnZXQgeFdoZWVsRW5hYmxlZCgpIHsgcmV0dXJuIHRoaXMuX3hXaGVlbEVuYWJsZWQ7IH1cbiAgc2V0IHhXaGVlbEVuYWJsZWQodmFsdWU6IGJvb2xlYW4pIHsgdGhpcy5feFdoZWVsRW5hYmxlZCA9IHZhbHVlOyB9XG5cbiAgQElucHV0KCdkcmFnLWRpc2FibGVkJylcbiAgZ2V0IGRyYWdEaXNhYmxlZCgpIHsgcmV0dXJuIHRoaXMuX2RyYWdEaXNhYmxlZDsgfVxuICBzZXQgZHJhZ0Rpc2FibGVkKHZhbHVlOiBib29sZWFuKSB7IHRoaXMuX2RyYWdEaXNhYmxlZCA9IHZhbHVlOyB9XG5cbiAgQElucHV0KCdzbmFwLWRpc2FibGVkJylcbiAgZ2V0IHNuYXBEaXNhYmxlZCgpIHsgcmV0dXJuIHRoaXMuX3NuYXBEaXNhYmxlZDsgfVxuICBzZXQgc25hcERpc2FibGVkKHZhbHVlOiBib29sZWFuKSB7IHRoaXMuX3NuYXBEaXNhYmxlZCA9IHZhbHVlOyB9XG5cbiAgQElucHV0KCdzbmFwLW9mZnNldCcpXG4gIGdldCBzbmFwT2Zmc2V0KCkgeyByZXR1cm4gdGhpcy5fc25hcE9mZnNldDsgfVxuICBzZXQgc25hcE9mZnNldCh2YWx1ZTogbnVtYmVyKSB7IHRoaXMuX3NuYXBPZmZzZXQgPSB2YWx1ZTsgfVxuXG4gIEBJbnB1dCgnc25hcC1kdXJhdGlvbicpXG4gIGdldCBzbmFwRHVyYXRpb24oKSB7IHJldHVybiB0aGlzLl9zbmFwRHVyYXRpb247IH1cbiAgc2V0IHNuYXBEdXJhdGlvbih2YWx1ZTogbnVtYmVyKSB7IHRoaXMuX3NuYXBEdXJhdGlvbiA9IHZhbHVlOyB9XG5cbiAgY29uc3RydWN0b3IoXG4gICAgQEluamVjdChFbGVtZW50UmVmKSBwcml2YXRlIF9lbGVtZW50UmVmOiBFbGVtZW50UmVmLFxuICAgIEBJbmplY3QoUmVuZGVyZXIyKSBwcml2YXRlIF9yZW5kZXJlcjogUmVuZGVyZXIyLFxuICAgIEBJbmplY3QoRE9DVU1FTlQpIHByaXZhdGUgX2RvY3VtZW50OiBhbnlcbiAgKSB7XG4gICAgdGhpcy5zY3JvbGxiYXJXaWR0aCA9IGAke3RoaXMuZ2V0U2Nyb2xsYmFyV2lkdGgoKX1weGA7XG4gIH1cblxuICBuZ09uQ2hhbmdlcygpIHtcbiAgICB0aGlzLnNldFNjcm9sbEJhcigpO1xuXG4gICAgaWYgKHRoaXMueERpc2FibGVkIHx8IHRoaXMuZGlzYWJsZWQpIHtcbiAgICAgIHRoaXMuZGlzYWJsZVNjcm9sbCgneCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmVuYWJsZVNjcm9sbCgneCcpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnlEaXNhYmxlZCB8fCB0aGlzLmRpc2FibGVkKSB7XG4gICAgICB0aGlzLmRpc2FibGVTY3JvbGwoJ3knKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbmFibGVTY3JvbGwoJ3knKTtcbiAgICB9XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgLy8gYXV0byBhc3NpZ24gY29tcHV0ZWQgY3NzXG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0QXR0cmlidXRlKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCwgJ2RyYWctc2Nyb2xsJywgJ3RydWUnKTtcblxuICAgIHRoaXMuZGlzcGxheVR5cGUgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudCkuZGlzcGxheSA6ICdibG9jayc7XG5cbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdkaXNwbGF5JywgdGhpcy5kaXNwbGF5VHlwZSk7XG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnd2hpdGVTcGFjZScsICdub1dyYXAnKTtcblxuICAgIC8vIHN0b3JlIGVsZSB3aWR0aCBoZWlnaHQgZm9yIGxhdGVyIHVzZXJcbiAgICB0aGlzLm1hcmtFbERpbWVuc2lvbigpO1xuXG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnd2lkdGgnLCB0aGlzLmVsV2lkdGgpO1xuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCwgJ2hlaWdodCcsIHRoaXMuZWxIZWlnaHQpO1xuXG4gICAgaWYgKHRoaXMud3JhcHBlcikge1xuICAgICAgdGhpcy5jaGVja1Njcm9sbGJhcigpO1xuICAgIH1cblxuICAgIHRoaXMuX29uTW91c2VEb3duTGlzdGVuZXIgPSB0aGlzLl9yZW5kZXJlci5saXN0ZW4odGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnbW91c2Vkb3duJywgdGhpcy5vbk1vdXNlRG93bkhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgdGhpcy5fb25TY3JvbGxMaXN0ZW5lciA9IHRoaXMuX3JlbmRlcmVyLmxpc3Rlbih0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdzY3JvbGwnLCB0aGlzLm9uU2Nyb2xsSGFuZGxlci5iaW5kKHRoaXMpKTtcbiAgICAvLyBwcmV2ZW50IEZpcmVmb3ggZnJvbSBkcmFnZ2luZyBpbWFnZXNcbiAgICB0aGlzLl9vbkRyYWdTdGFydExpc3RlbmVyID0gdGhpcy5fcmVuZGVyZXIubGlzdGVuKCdkb2N1bWVudCcsICdkcmFnc3RhcnQnLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuY2hlY2tOYXZTdGF0dXMoKTtcbiAgICB0aGlzLmRzSW5pdGlhbGl6ZWQuZW1pdCgpO1xuICAgIHRoaXMuYWRqdXN0TWFyZ2luVG9MYXN0Q2hpbGQoKTtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcbiAgICAvLyBhdm9pZCBleHRyYSBjaGVja3NcbiAgICBpZiAodGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ10ubGVuZ3RoICE9PSB0aGlzLnByZXZDaGlsZHJlbkxlbmd0aCkge1xuICAgICAgdGhpcy5tYXJrRWxEaW1lbnNpb24oKTtcbiAgICAgIHRoaXMuY2hlY2tTY3JvbGxiYXIoKTtcbiAgICAgIHRoaXMucHJldkNoaWxkcmVuTGVuZ3RoID0gdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ10ubGVuZ3RoO1xuICAgICAgdGhpcy5jaGVja05hdlN0YXR1cygpO1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMuX3JlbmRlcmVyLnNldEF0dHJpYnV0ZSh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdkcmFnLXNjcm9sbCcsICdmYWxzZScpO1xuICAgIGlmICh0aGlzLl9vbk1vdXNlRG93bkxpc3RlbmVyKSB7XG4gICAgICB0aGlzLl9vbk1vdXNlRG93bkxpc3RlbmVyID0gdGhpcy5fb25Nb3VzZURvd25MaXN0ZW5lcigpO1xuICAgIH1cbiAgICBpZiAodGhpcy5fb25TY3JvbGxMaXN0ZW5lcikge1xuICAgICAgdGhpcy5fb25TY3JvbGxMaXN0ZW5lciA9IHRoaXMuX29uU2Nyb2xsTGlzdGVuZXIoKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuX29uRHJhZ1N0YXJ0TGlzdGVuZXIpIHtcbiAgICAgIHRoaXMuX29uRHJhZ1N0YXJ0TGlzdGVuZXIgPSB0aGlzLl9vbkRyYWdTdGFydExpc3RlbmVyKCk7XG4gICAgfVxuICB9XG5cbiAgb25Nb3VzZU1vdmVIYW5kbGVyKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgdGhpcy5vbk1vdXNlTW92ZShldmVudCk7XG4gIH1cblxuICBvbk1vdXNlTW92ZShldmVudDogTW91c2VFdmVudCkge1xuICAgIGlmICh0aGlzLmlzUHJlc3NlZCAmJiAhdGhpcy5kaXNhYmxlZCkge1xuICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgcHJldmVudCBzY3JvbGwgc3R1Y2sgaWYgYnJvd3NlciBsb3N0IGZvY3VzXG4gICAgICAvLyBNb3VzZUV2ZW50LmJ1dHRvbnMgbm90IHN1cHBvcnQgYnkgU2FmYXJpXG4gICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6ZGVwcmVjYXRpb25cbiAgICAgIGlmICghZXZlbnQuYnV0dG9ucyAmJiAhZXZlbnQud2hpY2gpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub25Nb3VzZVVwSGFuZGxlcihldmVudCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX3BvaW50ZXJFdmVudHMgPSAnbm9uZSc7XG4gICAgICB0aGlzLl9zZXRJc0RyYWdnaW5nKHRydWUpO1xuXG4gICAgICAvLyBEcmFnIFhcbiAgICAgIGlmICghdGhpcy54RGlzYWJsZWQgJiYgIXRoaXMuZHJhZ0Rpc2FibGVkKSB7XG4gICAgICAgIGNvbnN0IGNsaWVudFggPSAoZXZlbnQgYXMgTW91c2VFdmVudCkuY2xpZW50WDtcbiAgICAgICAgdGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbExlZnQgPVxuICAgICAgICAgIHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0IC0gY2xpZW50WCArIHRoaXMuZG93blg7XG4gICAgICAgIHRoaXMuZG93blggPSBjbGllbnRYO1xuICAgICAgfVxuXG4gICAgICAvLyBEcmFnIFlcbiAgICAgIGlmICghdGhpcy55RGlzYWJsZWQgJiYgIXRoaXMuZHJhZ0Rpc2FibGVkKSB7XG4gICAgICAgIGNvbnN0IGNsaWVudFkgPSAoZXZlbnQgYXMgTW91c2VFdmVudCkuY2xpZW50WTtcbiAgICAgICAgdGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbFRvcCA9XG4gICAgICAgICAgdGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LnNjcm9sbFRvcCAtIGNsaWVudFkgKyB0aGlzLmRvd25ZO1xuICAgICAgICB0aGlzLmRvd25ZID0gY2xpZW50WTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBvbk1vdXNlRG93bkhhbmRsZXIoZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBjb25zdCBkcmFnU2Nyb2xsSXRlbTogRHJhZ1Njcm9sbEl0ZW1EaXJlY3RpdmUgfCBudWxsID0gdGhpcy5sb2NhdGVEcmFnU2Nyb2xsSXRlbShldmVudC50YXJnZXQgYXMgRWxlbWVudCk7XG4gICAgaWYgKGRyYWdTY3JvbGxJdGVtICYmIGRyYWdTY3JvbGxJdGVtLmRyYWdEaXNhYmxlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGlzVG91Y2hFdmVudCA9IGV2ZW50LnR5cGUgPT09ICd0b3VjaHN0YXJ0JztcblxuICAgIHRoaXMuX3N0YXJ0R2xvYmFsTGlzdGVuaW5nKGlzVG91Y2hFdmVudCk7XG4gICAgdGhpcy5pc1ByZXNzZWQgPSB0cnVlO1xuXG4gICAgY29uc3QgbW91c2VFdmVudCA9IGV2ZW50IGFzIE1vdXNlRXZlbnQ7XG4gICAgdGhpcy5kb3duWCA9IG1vdXNlRXZlbnQuY2xpZW50WDtcbiAgICB0aGlzLmRvd25ZID0gbW91c2VFdmVudC5jbGllbnRZO1xuXG4gICAgY2xlYXJUaW1lb3V0KHRoaXMuc2Nyb2xsVG9UaW1lciBhcyBudW1iZXIpO1xuICB9XG5cbiAgb25TY3JvbGxIYW5kbGVyKCkge1xuICAgIHRoaXMuY2hlY2tOYXZTdGF0dXMoKTtcbiAgICBpZiAoIXRoaXMuaXNQcmVzc2VkICYmICF0aGlzLmlzQW5pbWF0aW5nICYmICF0aGlzLnNuYXBEaXNhYmxlZCkge1xuICAgICAgdGhpcy5pc1Njcm9sbGluZyA9IHRydWU7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5zY3JvbGxUaW1lciBhcyBudW1iZXIpO1xuICAgICAgdGhpcy5zY3JvbGxUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLmlzU2Nyb2xsaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMubG9jYXRlQ3VycmVudEluZGV4KHRydWUpO1xuICAgICAgfSwgNTAwKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5sb2NhdGVDdXJyZW50SW5kZXgoKTtcbiAgICB9XG4gIH1cblxuICBvbk1vdXNlVXBIYW5kbGVyKGV2ZW50OiBNb3VzZUV2ZW50KSB7XG4gICAgaWYgKHRoaXMuaXNQcmVzc2VkKSB7XG4gICAgICB0aGlzLmlzUHJlc3NlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5fcG9pbnRlckV2ZW50cyA9ICdhdXRvJztcbiAgICAgIHRoaXMuX3NldElzRHJhZ2dpbmcoZmFsc2UpO1xuICAgICAgaWYgKCF0aGlzLnNuYXBEaXNhYmxlZCkge1xuICAgICAgICB0aGlzLmxvY2F0ZUN1cnJlbnRJbmRleCh0cnVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubG9jYXRlQ3VycmVudEluZGV4KCk7XG4gICAgICB9XG4gICAgICB0aGlzLl9zdG9wR2xvYmFsTGlzdGVuaW5nKCk7XG4gICAgfVxuICB9XG5cbiAgLypcbiAgICogTmF2IGJ1dHRvblxuICAgKi9cbiAgbW92ZUxlZnQoKSB7XG4gICAgaWYgKCh0aGlzLmN1cnJJbmRleCAhPT0gMCB8fCB0aGlzLnNuYXBEaXNhYmxlZCkpIHtcbiAgICAgIHRoaXMuY3VyckluZGV4LS07XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5zY3JvbGxUb1RpbWVyIGFzIG51bWJlcik7XG4gICAgICB0aGlzLnNjcm9sbFRvKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCwgdGhpcy50b0NoaWxkcmVuTG9jYXRpb24oKSwgdGhpcy5zbmFwRHVyYXRpb24pO1xuICAgIH1cbiAgfVxuXG4gIG1vdmVSaWdodCgpIHtcbiAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLndyYXBwZXIgfHwgdGhpcy5wYXJlbnROb2RlO1xuICAgIGNvbnN0IGNvbnRhaW5lcldpZHRoID0gY29udGFpbmVyID8gY29udGFpbmVyLmNsaWVudFdpZHRoIDogMDtcblxuICAgIGlmICghdGhpcy5pc1Njcm9sbFJlYWNoZXNSaWdodEVuZCgpICYmIHRoaXMuY3VyckluZGV4IDwgdGhpcy5tYXhpbXVtSW5kZXgoY29udGFpbmVyV2lkdGgsIHRoaXMuX2NoaWxkcmVuKSkge1xuICAgICAgdGhpcy5jdXJySW5kZXgrKztcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNjcm9sbFRvVGltZXIgYXMgbnVtYmVyKTtcbiAgICAgIHRoaXMuc2Nyb2xsVG8odGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCB0aGlzLnRvQ2hpbGRyZW5Mb2NhdGlvbigpLCB0aGlzLnNuYXBEdXJhdGlvbik7XG4gICAgfVxuICB9XG5cbiAgbW92ZVRvKGluZGV4OiBudW1iZXIpIHtcbiAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLndyYXBwZXIgfHwgdGhpcy5wYXJlbnROb2RlO1xuICAgIGNvbnN0IGNvbnRhaW5lcldpZHRoID0gY29udGFpbmVyID8gY29udGFpbmVyLmNsaWVudFdpZHRoIDogMDtcbiAgICBpZiAoXG4gICAgICBpbmRleCA+PSAwICYmXG4gICAgICBpbmRleCAhPT0gdGhpcy5jdXJySW5kZXggJiZcbiAgICAgIHRoaXMuY3VyckluZGV4IDw9IHRoaXMubWF4aW11bUluZGV4KGNvbnRhaW5lcldpZHRoLCB0aGlzLl9jaGlsZHJlbilcbiAgICApIHtcbiAgICAgIHRoaXMuY3VyckluZGV4ID0gTWF0aC5taW4oaW5kZXgsIHRoaXMubWF4aW11bUluZGV4KGNvbnRhaW5lcldpZHRoLCB0aGlzLl9jaGlsZHJlbikpO1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuc2Nyb2xsVG9UaW1lciBhcyBudW1iZXIpO1xuICAgICAgdGhpcy5zY3JvbGxUbyh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsIHRoaXMudG9DaGlsZHJlbkxvY2F0aW9uKCksIHRoaXMuc25hcER1cmF0aW9uKTtcbiAgICB9XG4gIH1cblxuICBjaGVja05hdlN0YXR1cygpIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGNvbnN0IG9ubHlPbmVJdGVtID0gQm9vbGVhbih0aGlzLl9jaGlsZHJlblsnX3Jlc3VsdHMnXS5sZW5ndGggPD0gMSk7XG4gICAgICBjb25zdCBjb250YWluZXJJc0xhcmdlclRoYW5Db250ZW50ID0gQm9vbGVhbih0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsV2lkdGggPD1cbiAgICAgICAgdGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LmNsaWVudFdpZHRoKTtcbiAgICAgIGlmIChvbmx5T25lSXRlbSB8fCBjb250YWluZXJJc0xhcmdlclRoYW5Db250ZW50KSB7XG4gICAgICAgIC8vIG9ubHkgb25lIGVsZW1lbnRcbiAgICAgICAgdGhpcy5yZWFjaGVzTGVmdEJvdW5kLmVtaXQodHJ1ZSk7XG4gICAgICAgIHRoaXMucmVhY2hlc1JpZ2h0Qm91bmQuZW1pdCh0cnVlKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc1Njcm9sbFJlYWNoZXNSaWdodEVuZCgpKSB7XG4gICAgICAgIC8vIHJlYWNoZWQgcmlnaHQgZW5kXG4gICAgICAgIHRoaXMucmVhY2hlc0xlZnRCb3VuZC5lbWl0KGZhbHNlKTtcbiAgICAgICAgdGhpcy5yZWFjaGVzUmlnaHRCb3VuZC5lbWl0KHRydWUpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCA9PT0gMCAmJlxuICAgICAgICB0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsV2lkdGggPiB0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuY2xpZW50V2lkdGgpIHtcbiAgICAgICAgLy8gcmVhY2hlZCBsZWZ0IGVuZFxuICAgICAgICB0aGlzLnJlYWNoZXNMZWZ0Qm91bmQuZW1pdCh0cnVlKTtcbiAgICAgICAgdGhpcy5yZWFjaGVzUmlnaHRCb3VuZC5lbWl0KGZhbHNlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGluIHRoZSBtaWRkbGVcbiAgICAgICAgdGhpcy5yZWFjaGVzTGVmdEJvdW5kLmVtaXQoZmFsc2UpO1xuICAgICAgICB0aGlzLnJlYWNoZXNSaWdodEJvdW5kLmVtaXQoZmFsc2UpO1xuICAgICAgfVxuICAgIH0sIDApO1xuICB9XG5cbiAgQEhvc3RMaXN0ZW5lcignd2hlZWwnLCBbJyRldmVudCddKVxuICBwdWJsaWMgb25XaGVlbChldmVudDogV2hlZWxFdmVudCkge1xuICAgIGlmICh0aGlzLl94V2hlZWxFbmFibGVkKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICBpZiAodGhpcy5fc25hcERpc2FibGVkKSB7XG4gICAgICAgIHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxCeShldmVudC5kZWx0YVksIDApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGV2ZW50LmRlbHRhWSA8IDApIHtcbiAgICAgICAgICB0aGlzLm1vdmVMZWZ0KCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuZGVsdGFZID4gMCkge1xuICAgICAgICAgIHRoaXMubW92ZVJpZ2h0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBASG9zdExpc3RlbmVyKCd3aW5kb3c6cmVzaXplJylcbiAgcHVibGljIG9uV2luZG93UmVzaXplKCkge1xuICAgIHRoaXMucmVmcmVzaFdyYXBwZXJEaW1lbnNpb25zKCk7XG4gIH1cblxuICBwcml2YXRlIF9zZXRJc0RyYWdnaW5nKHZhbHVlOiBib29sZWFuKSB7XG4gICAgaWYgKHRoaXMuX2lzRHJhZ2dpbmcgPT09IHZhbHVlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5faXNEcmFnZ2luZyA9IHZhbHVlO1xuICAgIHZhbHVlID8gdGhpcy5kcmFnU3RhcnQuZW1pdCgpIDogdGhpcy5kcmFnRW5kLmVtaXQoKTtcbiAgfVxuXG4gIHByaXZhdGUgX3N0YXJ0R2xvYmFsTGlzdGVuaW5nKGlzVG91Y2hFdmVudDogYm9vbGVhbikge1xuICAgIGlmICghdGhpcy5fb25Nb3VzZU1vdmVMaXN0ZW5lcikge1xuICAgICAgY29uc3QgZXZlbnROYW1lID0gaXNUb3VjaEV2ZW50ID8gJ3RvdWNobW92ZScgOiAnbW91c2Vtb3ZlJztcbiAgICAgIHRoaXMuX29uTW91c2VNb3ZlTGlzdGVuZXIgPSB0aGlzLl9yZW5kZXJlci5saXN0ZW4oJ2RvY3VtZW50JywgZXZlbnROYW1lLCB0aGlzLm9uTW91c2VNb3ZlSGFuZGxlci5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuX29uTW91c2VVcExpc3RlbmVyKSB7XG4gICAgICBjb25zdCBldmVudE5hbWUgPSBpc1RvdWNoRXZlbnQgPyAndG91Y2hlbmQnIDogJ21vdXNldXAnO1xuICAgICAgdGhpcy5fb25Nb3VzZVVwTGlzdGVuZXIgPSB0aGlzLl9yZW5kZXJlci5saXN0ZW4oJ2RvY3VtZW50JywgZXZlbnROYW1lLCB0aGlzLm9uTW91c2VVcEhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBfc3RvcEdsb2JhbExpc3RlbmluZygpIHtcbiAgICBpZiAodGhpcy5fb25Nb3VzZU1vdmVMaXN0ZW5lcikge1xuICAgICAgdGhpcy5fb25Nb3VzZU1vdmVMaXN0ZW5lciA9IHRoaXMuX29uTW91c2VNb3ZlTGlzdGVuZXIoKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fb25Nb3VzZVVwTGlzdGVuZXIpIHtcbiAgICAgIHRoaXMuX29uTW91c2VVcExpc3RlbmVyID0gdGhpcy5fb25Nb3VzZVVwTGlzdGVuZXIoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRpc2FibGVTY3JvbGwoYXhpczogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCBgb3ZlcmZsb3ctJHtheGlzfWAsICdoaWRkZW4nKTtcbiAgfVxuXG4gIHByaXZhdGUgZW5hYmxlU2Nyb2xsKGF4aXM6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCwgYG92ZXJmbG93LSR7YXhpc31gLCAnYXV0bycpO1xuICB9XG5cbiAgcHJpdmF0ZSBoaWRlU2Nyb2xsYmFyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnICYmICF0aGlzLndyYXBwZXIpIHtcbiAgICAgIHRoaXMucGFyZW50Tm9kZSA9IHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5wYXJlbnROb2RlO1xuXG4gICAgICAvLyBjcmVhdGUgY29udGFpbmVyIGVsZW1lbnRcbiAgICAgIHRoaXMud3JhcHBlciA9IHRoaXMuX3JlbmRlcmVyLmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0QXR0cmlidXRlKHRoaXMud3JhcHBlciwgJ2NsYXNzJywgJ2RyYWctc2Nyb2xsLXdyYXBwZXInKTtcbiAgICAgIHRoaXMuX3JlbmRlcmVyLmFkZENsYXNzKHRoaXMud3JhcHBlciwgJ2RyYWctc2Nyb2xsLWNvbnRhaW5lcicpO1xuXG4gICAgICB0aGlzLnJlZnJlc2hXcmFwcGVyRGltZW5zaW9ucygpO1xuXG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLndyYXBwZXIsICdvdmVyZmxvdycsICdoaWRkZW4nKTtcblxuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnd2lkdGgnLCBgY2FsYygxMDAlICsgJHt0aGlzLnNjcm9sbGJhcldpZHRofSlgKTtcbiAgICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCwgJ2hlaWdodCcsIGBjYWxjKDEwMCUgKyAke3RoaXMuc2Nyb2xsYmFyV2lkdGh9KWApO1xuXG4gICAgICAvLyBBcHBlbmQgY29udGFpbmVyIGVsZW1lbnQgdG8gY29tcG9uZW50IGVsZW1lbnQuXG4gICAgICB0aGlzLl9yZW5kZXJlci5hcHBlbmRDaGlsZCh0aGlzLl9lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQsIHRoaXMud3JhcHBlcik7XG5cbiAgICAgIC8vIEFwcGVuZCBjb250ZW50IGVsZW1lbnQgdG8gY29udGFpbmVyIGVsZW1lbnQuXG4gICAgICB0aGlzLl9yZW5kZXJlci5hcHBlbmRDaGlsZCh0aGlzLndyYXBwZXIsIHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCk7XG5cbiAgICAgIHRoaXMuYWRqdXN0TWFyZ2luVG9MYXN0Q2hpbGQoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNob3dTY3JvbGxiYXIoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMud3JhcHBlcikge1xuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnd2lkdGgnLCAnMTAwJScpO1xuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnaGVpZ2h0JywgdGhpcy53cmFwcGVyLnN0eWxlLmhlaWdodCk7XG4gICAgICBpZiAodGhpcy5wYXJlbnROb2RlICE9PSBudWxsKSB7XG4gICAgICAgIHRoaXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLndyYXBwZXIpO1xuICAgICAgICB0aGlzLnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50KTtcbiAgICAgIH1cbiAgICAgIHRoaXMud3JhcHBlciA9IG51bGw7XG5cbiAgICAgIHRoaXMuYWRqdXN0TWFyZ2luVG9MYXN0Q2hpbGQoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNoZWNrU2Nyb2xsYmFyKCkge1xuICAgIGlmICh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsV2lkdGggPD0gdGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LmNsaWVudFdpZHRoKSB7XG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdoZWlnaHQnLCAnMTAwJScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICdoZWlnaHQnLCBgY2FsYygxMDAlICsgJHt0aGlzLnNjcm9sbGJhcldpZHRofSlgKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxIZWlnaHQgPD0gdGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LmNsaWVudEhlaWdodCkge1xuICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUodGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50LCAnd2lkdGgnLCAnMTAwJScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQsICd3aWR0aCcsIGBjYWxjKDEwMCUgKyAke3RoaXMuc2Nyb2xsYmFyV2lkdGh9KWApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2V0U2Nyb2xsQmFyKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnNjcm9sbGJhckhpZGRlbikge1xuICAgICAgdGhpcy5oaWRlU2Nyb2xsYmFyKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2hvd1Njcm9sbGJhcigpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0U2Nyb2xsYmFyV2lkdGgoKTogbnVtYmVyIHtcbiAgICAvKipcbiAgICAgKiBCcm93c2VyIFNjcm9sbGJhciBXaWR0aHMgKDIwMTYpXG4gICAgICogT1NYIChDaHJvbWUsIFNhZmFyaSwgRmlyZWZveCkgLSAxNXB4XG4gICAgICogV2luZG93cyBYUCAoSUU3LCBDaHJvbWUsIEZpcmVmb3gpIC0gMTdweFxuICAgICAqIFdpbmRvd3MgNyAoSUUxMCwgSUUxMSwgQ2hyb21lLCBGaXJlZm94KSAtIDE3cHhcbiAgICAgKiBXaW5kb3dzIDguMSAoSUUxMSwgQ2hyb21lLCBGaXJlZm94KSAtIDE3cHhcbiAgICAgKiBXaW5kb3dzIDEwIChJRTExLCBDaHJvbWUsIEZpcmVmb3gpIC0gMTdweFxuICAgICAqIFdpbmRvd3MgMTAgKEVkZ2UgMTIvMTMpIC0gMTJweFxuICAgICAqL1xuICAgIGNvbnN0IG91dGVyID0gdGhpcy5fcmVuZGVyZXIuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUob3V0ZXIsICd2aXNpYmlsaXR5JywgJ2hpZGRlbicpO1xuICAgIHRoaXMuX3JlbmRlcmVyLnNldFN0eWxlKG91dGVyLCAnd2lkdGgnLCAnMTAwcHgnKTtcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShvdXRlciwgJ21zT3ZlcmZsb3dTdHlsZScsICdzY3JvbGxiYXInKTsgIC8vIG5lZWRlZCBmb3IgV2luSlMgYXBwc1xuICAgIC8vIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQob3V0ZXIpO1xuICAgIHRoaXMuX3JlbmRlcmVyLmFwcGVuZENoaWxkKHRoaXMuX2RvY3VtZW50LmJvZHksIG91dGVyKTtcbiAgICAvLyB0aGlzLl9yZW5kZXJlci5hcHBlbmRDaGlsZCh0aGlzLl9yZW5kZXJlci5zZWxlY3RSb290RWxlbWVudCgnYm9keScpLCBvdXRlcik7XG4gICAgY29uc3Qgd2lkdGhOb1Njcm9sbCA9IG91dGVyLm9mZnNldFdpZHRoO1xuICAgIC8vIGZvcmNlIHNjcm9sbGJhcnNcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShvdXRlciwgJ292ZXJmbG93JywgJ3Njcm9sbCcpO1xuXG4gICAgLy8gYWRkIGlubmVyZGl2XG4gICAgY29uc3QgaW5uZXIgPSB0aGlzLl9yZW5kZXJlci5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShpbm5lciwgJ3dpZHRoJywgJzEwMCUnKTtcbiAgICB0aGlzLl9yZW5kZXJlci5hcHBlbmRDaGlsZChvdXRlciwgaW5uZXIpO1xuXG4gICAgY29uc3Qgd2lkdGhXaXRoU2Nyb2xsID0gaW5uZXIub2Zmc2V0V2lkdGg7XG5cbiAgICAvLyByZW1vdmUgZGl2c1xuICAgIHRoaXMuX3JlbmRlcmVyLnJlbW92ZUNoaWxkKHRoaXMuX2RvY3VtZW50LmJvZHksIG91dGVyKTtcblxuICAgIC8qKlxuICAgICAqIFNjcm9sbGJhciB3aWR0aCB3aWxsIGJlIDAgb24gTWFjIE9TIHdpdGggdGhlXG4gICAgICogZGVmYXVsdCBcIk9ubHkgc2hvdyBzY3JvbGxiYXJzIHdoZW4gc2Nyb2xsaW5nXCIgc2V0dGluZyAoWW9zZW1pdGUgYW5kIHVwKS5cbiAgICAgKiBzZXR0aW5nIGRlZmF1bHQgd2lkdGggdG8gMjA7XG4gICAgICovXG4gICAgcmV0dXJuIHdpZHRoTm9TY3JvbGwgLSB3aWR0aFdpdGhTY3JvbGwgfHwgMjA7XG4gIH1cblxuICBwcml2YXRlIHJlZnJlc2hXcmFwcGVyRGltZW5zaW9ucygpIHtcbiAgICBpZiAodGhpcy53cmFwcGVyKSB7XG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLndyYXBwZXIsICd3aWR0aCcsICcxMDAlJyk7XG4gICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZSh0aGlzLndyYXBwZXIsICdoZWlnaHQnLCB0aGlzLl9lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUuaGVpZ2h0XG4gICAgICAgIHx8IHRoaXMuX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5vZmZzZXRIZWlnaHQgKyAncHgnKTtcbiAgICB9XG4gIH1cblxuICAvKlxuICAqIFRoZSBiZWxvdyBzb2x1dGlvbiBpcyBoZWF2aWx5IGluc3BpcmVkIGZyb21cbiAgKiBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9hbmRqb3NoLzY3NjQ5MzlcbiAgKi9cbiAgcHJpdmF0ZSBzY3JvbGxUbyhlbGVtZW50OiBFbGVtZW50LCB0bzogbnVtYmVyLCBkdXJhdGlvbjogbnVtYmVyKSB7XG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5pc0FuaW1hdGluZyA9IHRydWU7XG4gICAgY29uc3Qgc3RhcnQgPSBlbGVtZW50LnNjcm9sbExlZnQsXG4gICAgICBjaGFuZ2UgPSB0byAtIHN0YXJ0IC0gdGhpcy5zbmFwT2Zmc2V0LFxuICAgICAgaW5jcmVtZW50ID0gMjA7XG4gICAgbGV0IGN1cnJlbnRUaW1lID0gMDtcblxuICAgIC8vIHQgPSBjdXJyZW50IHRpbWVcbiAgICAvLyBiID0gc3RhcnQgdmFsdWVcbiAgICAvLyBjID0gY2hhbmdlIGluIHZhbHVlXG4gICAgLy8gZCA9IGR1cmF0aW9uXG4gICAgY29uc3QgZWFzZUluT3V0UXVhZCA9IGZ1bmN0aW9uICh0OiBudW1iZXIsIGI6IG51bWJlciwgYzogbnVtYmVyLCBkOiBudW1iZXIpIHtcbiAgICAgIHQgLz0gZCAvIDI7XG4gICAgICBpZiAodCA8IDEpIHtcbiAgICAgICAgcmV0dXJuIGMgLyAyICogdCAqIHQgKyBiO1xuICAgICAgfVxuICAgICAgdC0tO1xuICAgICAgcmV0dXJuIC1jIC8gMiAqICh0ICogKHQgLSAyKSAtIDEpICsgYjtcbiAgICB9O1xuXG4gICAgY29uc3QgYW5pbWF0ZVNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGN1cnJlbnRUaW1lICs9IGluY3JlbWVudDtcbiAgICAgIGVsZW1lbnQuc2Nyb2xsTGVmdCA9IGVhc2VJbk91dFF1YWQoY3VycmVudFRpbWUsIHN0YXJ0LCBjaGFuZ2UsIGR1cmF0aW9uKTtcbiAgICAgIGlmIChjdXJyZW50VGltZSA8IGR1cmF0aW9uKSB7XG4gICAgICAgIHNlbGYuc2Nyb2xsVG9UaW1lciA9IHNldFRpbWVvdXQoYW5pbWF0ZVNjcm9sbCwgaW5jcmVtZW50KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIHJ1biBvbmUgbW9yZSBmcmFtZSB0byBtYWtlIHN1cmUgdGhlIGFuaW1hdGlvbiBpcyBmdWxseSBmaW5pc2hlZFxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBzZWxmLmlzQW5pbWF0aW5nID0gZmFsc2U7XG4gICAgICAgICAgc2VsZi5zbmFwQW5pbWF0aW9uRmluaXNoZWQuZW1pdChzZWxmLmN1cnJJbmRleCk7XG4gICAgICAgIH0sIGluY3JlbWVudCk7XG4gICAgICB9XG4gICAgfTtcbiAgICBhbmltYXRlU2Nyb2xsKCk7XG4gIH1cblxuICBwcml2YXRlIGxvY2F0ZUN1cnJlbnRJbmRleChzbmFwPzogYm9vbGVhbikge1xuICAgIHRoaXMuY3VycmVudENoaWxkV2lkdGgoKGN1cnJlbnRDaGlsZFdpZHRoLCBuZXh0Q2hpbGRyZW5XaWR0aCwgY2hpbGRyZW5XaWR0aCwgaWR4OiBudW1iZXIsIHN0b3ApID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ID49IGNoaWxkcmVuV2lkdGggJiZcbiAgICAgICAgICB0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCA8PSBuZXh0Q2hpbGRyZW5XaWR0aClcbiAgICAgICkge1xuICAgICAgICBpZiAobmV4dENoaWxkcmVuV2lkdGggLSB0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCA+IGN1cnJlbnRDaGlsZFdpZHRoIC8gMiAmJiAhdGhpcy5pc1Njcm9sbFJlYWNoZXNSaWdodEVuZCgpKSB7XG4gICAgICAgICAgLy8gcm9sbCBiYWNrIHNjcm9sbGluZ1xuICAgICAgICAgIGlmICghdGhpcy5pc0FuaW1hdGluZykge1xuICAgICAgICAgICAgdGhpcy5jdXJySW5kZXggPSBpZHg7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzbmFwKSB7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbFRvKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCwgY2hpbGRyZW5XaWR0aCwgdGhpcy5zbmFwRHVyYXRpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9jb250ZW50UmVmLm5hdGl2ZUVsZW1lbnQuc2Nyb2xsTGVmdCAhPT0gMCkge1xuICAgICAgICAgIC8vIGZvcndhcmQgc2Nyb2xsaW5nXG4gICAgICAgICAgaWYgKCF0aGlzLmlzQW5pbWF0aW5nKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJJbmRleCA9IGlkeCArIDE7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzbmFwKSB7XG4gICAgICAgICAgICB0aGlzLnNjcm9sbFRvKHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudCwgY2hpbGRyZW5XaWR0aCArIGN1cnJlbnRDaGlsZFdpZHRoLCB0aGlzLnNuYXBEdXJhdGlvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHN0b3AoKTtcbiAgICAgIH0gZWxzZSBpZiAoKGlkeCArIDEpID09PSAodGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ10ubGVuZ3RoIC0gMSkpIHtcbiAgICAgICAgLy8gcmVhY2hlcyBsYXN0IGluZGV4XG4gICAgICAgIGlmICghdGhpcy5pc0FuaW1hdGluZykge1xuICAgICAgICAgIHRoaXMuY3VyckluZGV4ID0gaWR4ICsgMTtcbiAgICAgICAgfVxuICAgICAgICBzdG9wKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGN1cnJlbnRDaGlsZFdpZHRoKGNiOiAoXG4gICAgY3VycmVudENsaWxkV2lkdGg6IG51bWJlcixcbiAgICBuZXh0Q2hpbGRyZW5XaWR0aDogbnVtYmVyLFxuICAgIGNoaWxkcmVuV2lkdGg6IG51bWJlcixcbiAgICBpbmRleDogbnVtYmVyLFxuICAgIGJyZWFrRnVuYzogKCkgPT4gdm9pZCkgPT4gdm9pZCkge1xuICAgIGxldCBjaGlsZHJlbldpZHRoID0gMDtcbiAgICBsZXQgc2hvdWxkQnJlYWsgPSBmYWxzZTtcbiAgICBjb25zdCBicmVha0Z1bmMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBzaG91bGRCcmVhayA9IHRydWU7XG4gICAgfTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2NoaWxkcmVuWydfcmVzdWx0cyddLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoaSA9PT0gdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ10ubGVuZ3RoIC0gMSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmIChzaG91bGRCcmVhaykge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgY29uc3QgbmV4dENoaWxkcmVuV2lkdGggPSBjaGlsZHJlbldpZHRoICsgdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ11baSArIDFdLl9lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuY2xpZW50V2lkdGg7XG4gICAgICBjb25zdCBjdXJyZW50Q2xpbGRXaWR0aCA9IHRoaXMuX2NoaWxkcmVuWydfcmVzdWx0cyddW2ldLl9lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuY2xpZW50V2lkdGg7XG4gICAgICBjYihjdXJyZW50Q2xpbGRXaWR0aCwgbmV4dENoaWxkcmVuV2lkdGgsIGNoaWxkcmVuV2lkdGgsIGksIGJyZWFrRnVuYyk7XG5cbiAgICAgIGNoaWxkcmVuV2lkdGggKz0gY3VycmVudENsaWxkV2lkdGg7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSB0b0NoaWxkcmVuTG9jYXRpb24oKTogbnVtYmVyIHtcbiAgICBsZXQgdG8gPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jdXJySW5kZXg7IGkrKykge1xuICAgICAgdG8gKz0gdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ11baV0uX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5jbGllbnRXaWR0aDtcbiAgICB9XG4gICAgcmV0dXJuIHRvO1xuICB9XG5cbiAgcHJpdmF0ZSBsb2NhdGVEcmFnU2Nyb2xsSXRlbShlbGVtZW50OiBFbGVtZW50KTogRHJhZ1Njcm9sbEl0ZW1EaXJlY3RpdmUgfCBudWxsIHtcbiAgICBsZXQgaXRlbTogRHJhZ1Njcm9sbEl0ZW1EaXJlY3RpdmUgfCBudWxsID0gbnVsbDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2NoaWxkcmVuWydfcmVzdWx0cyddLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoZWxlbWVudCA9PT0gdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ11baV0uX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudCkge1xuICAgICAgICBpdGVtID0gdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ11baV07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpdGVtO1xuICB9XG5cbiAgcHJpdmF0ZSBtYXJrRWxEaW1lbnNpb24oKSB7XG4gICAgaWYgKHRoaXMud3JhcHBlcikge1xuICAgICAgdGhpcy5lbFdpZHRoID0gdGhpcy53cmFwcGVyLnN0eWxlLndpZHRoO1xuICAgICAgdGhpcy5lbEhlaWdodCA9IHRoaXMud3JhcHBlci5zdHlsZS5oZWlnaHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZWxXaWR0aCA9IHRoaXMuX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5zdHlsZS53aWR0aCB8fCAodGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoICsgJ3B4Jyk7XG4gICAgICB0aGlzLmVsSGVpZ2h0ID0gdGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LnN0eWxlLmhlaWdodCB8fCAodGhpcy5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50Lm9mZnNldEhlaWdodCArICdweCcpO1xuICAgIH1cbiAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLndyYXBwZXIgfHwgdGhpcy5wYXJlbnROb2RlO1xuICAgIGNvbnN0IGNvbnRhaW5lcldpZHRoID0gY29udGFpbmVyID8gY29udGFpbmVyLmNsaWVudFdpZHRoIDogMDtcbiAgICBpZiAodGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ10ubGVuZ3RoID4gMSkge1xuICAgICAgdGhpcy5pbmRleEJvdW5kID0gIHRoaXMubWF4aW11bUluZGV4KGNvbnRhaW5lcldpZHRoLCB0aGlzLl9jaGlsZHJlbik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBtYXhpbXVtSW5kZXgoY29udGFpbmVyV2lkdGg6IG51bWJlciwgY2hpbGRyZW5FbGVtZW50czogUXVlcnlMaXN0PERyYWdTY3JvbGxJdGVtRGlyZWN0aXZlPik6IG51bWJlciB7XG4gICAgbGV0IGNvdW50ID0gMDtcbiAgICBsZXQgY2hpbGRyZW5XaWR0aCA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gY2hpbGRyZW5FbGVtZW50c1snX3Jlc3VsdHMnXS5sZW5ndGg7IGkrKykge1xuICAgICAgLy8gbGFzdCBOIGVsZW1lbnRcbiAgICAgIGNvbnN0IGRyYWdTY3JvbGxJdGVtRGlyZWN0aXZlOiBEcmFnU2Nyb2xsSXRlbURpcmVjdGl2ZSA9IGNoaWxkcmVuRWxlbWVudHNbJ19yZXN1bHRzJ11bY2hpbGRyZW5FbGVtZW50c1snX3Jlc3VsdHMnXS5sZW5ndGggLSAxIC0gaV07XG4gICAgICBpZiAoIWRyYWdTY3JvbGxJdGVtRGlyZWN0aXZlKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV0IGl0ZW1XaWR0aCA9IGRyYWdTY3JvbGxJdGVtRGlyZWN0aXZlLl9lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQuY2xpZW50V2lkdGg7XG4gICAgICAgIGlmIChpdGVtV2lkdGggPT09IDApIHtcbiAgICAgICAgICBpdGVtV2lkdGggPSBkcmFnU2Nyb2xsSXRlbURpcmVjdGl2ZS5fZWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LmZpcnN0RWxlbWVudENoaWxkLmNsaWVudFdpZHRoO1xuICAgICAgICB9XG4gICAgICAgIGNoaWxkcmVuV2lkdGggKz0gaXRlbVdpZHRoO1xuICAgICAgICBpZiAoY2hpbGRyZW5XaWR0aCA8IGNvbnRhaW5lcldpZHRoKSB7XG4gICAgICAgICAgY291bnQrKztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY2hpbGRyZW5FbGVtZW50cy5sZW5ndGggLSBjb3VudDtcbiAgfVxuXG4gIHByaXZhdGUgaXNTY3JvbGxSZWFjaGVzUmlnaHRFbmQoKTogYm9vbGVhbiB7XG4gICAgY29uc3Qgc2Nyb2xsTGVmdFBvcyA9IHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxMZWZ0ICsgdGhpcy5fY29udGVudFJlZi5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoO1xuICAgIHJldHVybiBzY3JvbGxMZWZ0UG9zID49IHRoaXMuX2NvbnRlbnRSZWYubmF0aXZlRWxlbWVudC5zY3JvbGxXaWR0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBhZGRzIGEgbWFyZ2luIHJpZ2h0IHN0eWxlIHRvIHRoZSBsYXN0IGNoaWxkIGVsZW1lbnQgd2hpY2ggd2lsbCByZXNvbHZlIHRoZSBpc3N1ZVxuICAgKiBvZiBsYXN0IGl0ZW0gZ2V0cyBjdXRvZmYuXG4gICAqL1xuICBwcml2YXRlIGFkanVzdE1hcmdpblRvTGFzdENoaWxkKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9jaGlsZHJlbiAmJiB0aGlzLmhpZGVTY3JvbGxiYXIpIHtcbiAgICAgIGNvbnN0IGxhc3RJdGVtID0gdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ11bdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ10ubGVuZ3RoIC0gMV0uX2VsZW1lbnRSZWYubmF0aXZlRWxlbWVudDtcbiAgICAgIGlmICh0aGlzLndyYXBwZXIgJiYgdGhpcy5fY2hpbGRyZW5bJ19yZXN1bHRzJ10ubGVuZ3RoID4gMSkge1xuICAgICAgICB0aGlzLl9yZW5kZXJlci5zZXRTdHlsZShsYXN0SXRlbSwgJ21hcmdpbi1yaWdodCcsIHRoaXMuc2Nyb2xsYmFyV2lkdGgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIuc2V0U3R5bGUobGFzdEl0ZW0sICdtYXJnaW4tcmlnaHQnLCAwKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdfQ==